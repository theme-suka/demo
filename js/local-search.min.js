/*!
 * Hexo Theme Suka | local-search.js
 * Author: SukkaW
 * Link: https://github.com/SukkaW/hexo-theme-suka
 * License: GPL-3.0
 */
!function(){window.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null==t?"":decodeURIComponent(t[1])};var o=window.getParameterByName("s");window.searchFunc=function(e,i){"use strict";fetch(e).then(function(e){return e.json()}).then(function(t){var n=document.getElementById("search-output"),r=document.getElementById("search-result-num"),a=document.getElementById("search-result-info"),E=[];void 0!==o&&(!function(p){var w=function(){var e=p.trim().toLowerCase().split(/[\s\-]+/),t=[];for(var n in e){var r=e[n];if(-1<r.indexOf("+")){var a=r.split("+");for(var i in a)t.push(a[i])}else t.push(r)}return t}();window.searchKeyword=w;var y=0;if(n.innerHTML="",!(p.trim().length<=0)){t.forEach(function(e){if(void 0!==e.title&&void 0!==e.content){var n=!0,r=e.title.trim().toLowerCase(),t=new Date(e.date).toLocaleDateString(),a=void 0!==e.tags?e.tags:[],i=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=-1,s=-1,c=-1,l=-1,u=0;if(""!==r&&""!==i&&w.forEach(function(e,t){o=r.indexOf(e),s=a.indexOf(e),c=i.indexOf(e),o<0&&s<0&&c<0?n=!1:(0<=o&&(u+=4),0<=s&&(u+=2),0<=c&&(u+=1),0===t&&(l=c),y++)}),n){var d="";d+='<div class="tile"><div class="tile-content">';var f=e.title;w.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,"<strong><mark>"+e+"</mark></strong>")}),d+='<a href="'+e.url+'"><p class="tile-title search-result-title">'+f+"</p></a>",d+='<p class="text-gray search-result-summary">',d+='<span class="saerch-result-date">'+t+"</span>";var v=e.content;if(0<=l){var h=l-15,g=l+20;h<0&&(h=0),0===h&&(g=20),g>v.length&&(g=v.length-20);var m=v.substr(h,g);w.forEach(function(e){var t=new RegExp(e,"gi");m=m.replace(t,"<strong><mark>"+p+"</mark></strong>")}),d+=m+"...</p>"}d+="</div></div>",E.push([d,u])}}});var e=function(){var e="";for(var t in E.sort(function(e,t){return t[1]-e[1]}),E)e+=E[t][0];return e}();r.innerHTML=E.length,n.innerHTML=y<=0?(a.style.display="none",i):(a.style.display="block",e)}}(o),document.getElementById("search-field").setAttribute("value",o))})}}();